<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>oaibuilds — O-Systems</title>
  <meta name="description" content="O-Systems by oaibuilds. Intelligent systems, agentic architectures, and tools." />
  <link rel="canonical" href="https://oaibuilds.com/" />
  <meta name="color-scheme" content="dark light">
  <meta name="theme-color" content="#0b0b0d" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">

  <!-- Social -->
  <meta property="og:title" content="oaibuilds — O-Systems" />
  <meta property="og:description" content="Intelligent systems & agentic architectures for an AI-driven world." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://oaibuilds.com/" />
  <meta property="og:image" content="https://oaibuilds.com/og-image.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <link rel="icon" href="/favicon.ico">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    /* ===================== Design tokens ===================== */
    :root{
      /* colors */
      --bg:#0b0b0d; --txt:#f2f3f5; --muted:#a9afbd; --card:#0f1117; --border:#1b1e27;
      --brand-1:#7c3aed; --brand-2:#0d7a8d; --ok:#22c55e; --warn:#f59e0b;
      --glass: rgba(12,12,14,.7);
      /* typography */
      --ff:'Space Grotesk', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      --fs-1: clamp(2.0rem, 3.6vw, 2.8rem); /* hero */
      --fs-2: clamp(1.15rem, 2.2vw, 1.45rem); /* section lead */
      --fs-3: 1.02rem;                        /* body */
      --fs-4: .9rem;                          /* small */
      /* spacing */
      --g-1:.5rem; --g-2:.75rem; --g-3:1rem; --g-4:1.5rem; --g-5:2rem; --g-6:3rem; --g-7:4.5rem;
      /* radii */
      --r-1:12px; --r-2:16px; --r-3:24px;
      /* shadows */
      --shadow-1: 0 1px 0 rgba(255,255,255,.02), 0 12px 40px rgba(0,0,0,.35);
    }
    @media (prefers-color-scheme: light){
      :root{ --bg:#ffffff; --txt:#0d0d10; --muted:#5b5f6b; --card:#f6f7fb; --border:#e6e8ef; --glass: rgba(255,255,255,.7); }
    }

    /* ===================== Base ===================== */
    *,*::before,*::after{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      background:
        radial-gradient(900px 520px at 8% -10%, rgba(124,58,237,.10), transparent),
        radial-gradient(900px 520px at 92% 110%, rgba(13,122,141,.10), transparent),
        var(--bg);
      color:var(--txt);
      font:400 var(--fs-3)/1.6 var(--ff);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow-x:hidden;
    }
    a{color:inherit}
    .visually-hidden{position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;border:0}

    /* Safe container with mobile-friendly side padding + notches */
    .container{
      max-width:1120px;
      margin:0 auto;
      padding-left: max(env(safe-area-inset-left), clamp(16px, 6vw, 32px));
      padding-right:max(env(safe-area-inset-right), clamp(16px, 6vw, 32px));
    }
    .section{padding: var(--g-6) 0}

    /* Focus styles */
    :where(a,button,[tabindex]):focus{outline:2px solid var(--brand-1);outline-offset:2px;border-radius:6px}

    /* ===================== Skip link ===================== */
    .skip{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
    .skip:focus{left:var(--g-3);top:var(--g-3);width:auto;height:auto;padding:.5rem .75rem;background:var(--card);border:1px solid var(--border);border-radius:8px}

    /* ===================== Header / Nav ===================== */
    header.site{position:sticky;top:0;z-index:50;background:var(--glass);backdrop-filter:saturate(140%) blur(8px);border-bottom:1px solid var(--border)}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:.7rem max(env(safe-area-inset-right), 16px) .7rem max(env(safe-area-inset-left), 16px)}
    .brand{display:flex;align-items:center;gap:.6rem;font-weight:700;letter-spacing:.02em}
    .dot{width:10px;height:10px;border-radius:50%;background: radial-gradient(circle at 40% 40%, #fff, var(--brand-1));box-shadow:0 0 12px rgba(124,58,237,.55)}
    nav.primary a{color:var(--muted);text-decoration:none;font-weight:600;margin-left:1rem}
    nav.primary a:hover{color:var(--txt)}

    /* Mobile nav (no JS) */
    #menu-toggle{display:none}
    .menu-btn{display:none}
    @media (max-width:820px){
      .menu-btn{display:inline-flex;align-items:center;gap:.5rem;border:1px solid var(--border);border-radius:10px;padding:.45rem .6rem;background:transparent}
      nav.primary{position:absolute;inset:55px 0 auto 0;background:var(--card);border-bottom:1px solid var(--border);display:none}
      #menu-toggle:checked + .menu-btn + nav.primary{display:block}
      nav.primary .container{padding-left:max(env(safe-area-inset-left), clamp(16px,6vw,32px));padding-right:max(env(safe-area-inset-right), clamp(16px,6vw,32px))}
      nav.primary a{display:block;padding:.75rem 0;margin:0;border-top:1px solid var(--border)}
    }

    /* ===================== Hero ===================== */
    .hero{display:grid;grid-template-columns:1fr;gap:var(--g-5);align-items:center;padding: var(--g-7) 0 var(--g-6)}
    @media (min-width:900px){.hero{grid-template-columns:1.15fr .85fr}}
    .h-title{margin:0;font-size:var(--fs-1);font-weight:700;letter-spacing:.01em;line-height:1.15}
    .h-sub{color:var(--muted);margin:.35rem 0 0;font-size:calc(var(--fs-3) * .98)}
    .h-tag{margin:.7rem 0 0;font-size:var(--fs-2);font-weight:600;color:var(--brand-2)}
    .cta{display:flex;flex-wrap:wrap;gap:.75rem;margin-top:var(--g-4)}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.7rem 1rem;border:1px solid var(--border);border-radius:12px;font-weight:700;text-decoration:none}
    .btn.primary{background:linear-gradient(90deg,var(--brand-1),var(--brand-2));border-color:transparent;color:white}

    /* Margen lateral solo para texto en móvil */
    @media (max-width:640px){
      .hero .h-title, .hero .h-sub, .hero .h-tag {padding-left: max(env(safe-area-inset-left), 20px);padding-right: max(env(safe-area-inset-right), 20px)}
    }

    /* Brand highlight + no wrap */
    .brandmark{background: linear-gradient(90deg,var(--brand-1),var(--brand-2));-webkit-background-clip: text;background-clip: text;-webkit-text-fill-color: transparent;font-weight:700}
    .nowrap{ white-space: nowrap }

    /* Extra-small screens tweaks */
    @media (max-width:420px){
      :root{ --fs-1: clamp(1.8rem, 7vw, 2.1rem); --fs-2: clamp(1.05rem, 4.5vw, 1.2rem) }
      .cta{flex-wrap: nowrap; justify-content: space-between; gap: .5rem; margin-left: max(env(safe-area-inset-left), 16px); margin-right: max(env(safe-area-inset-right), 16px)}
      .cta .btn{flex: 1 0 auto; min-width: 44%}
      .h-tag{margin-top:.5rem}
    }
    @media (max-width:360px){ :root{ --fs-1: 1.75rem; --fs-2: 1.05rem } }

    /* Orb */
    .orbwrap{position:relative;width:min(360px,80vw);aspect-ratio:1/1;margin-inline:auto}
    canvas#oOrb{width:100%;height:100%;display:block;border-radius:50%;box-shadow:0 0 0 1px var(--border), 0 20px 60px rgba(0,0,0,.45)}
    .orbglow{position:absolute;inset:-8%;border-radius:50%;background:radial-gradient(40% 40% at 50% 50%, rgba(124,58,237,.25), transparent 60%);pointer-events:none}

    /* ===================== Cards / Grid ===================== */
    .grid{display:grid;gap:var(--g-3)}
    @media (min-width:780px){.grid.cols-2{grid-template-columns:1fr 1fr}}
    .card{background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0)), var(--card);border:1px solid var(--border);border-radius:var(--r-2);padding:1.25rem;box-shadow:var(--shadow-1);opacity:0;transform:translateY(8px)}
    .card.revealed{opacity:1;transform:none;transition:transform .6s cubic-bezier(.2,.7,.2,1), opacity .6s ease}
    .card h2{margin:0 0 .35rem;font-size:1.1rem;color:var(--brand-2)}
    .card p{margin:.35rem 0 .9rem;color:var(--muted)}

    /* ===================== Elements ===================== */
    .ai-banner{margin:var(--g-6) auto var(--g-5);padding:1rem;text-align:center;background:rgba(124,58,237,.08);border:1px solid var(--border);border-radius:12px;font-weight:500;color:var(--muted);max-width:720px}
    .badges{display:flex;flex-wrap:wrap;gap:.5rem;justify-content:center;margin-top:.5rem}
    .badge{padding:.35rem .55rem;border:1px solid var(--border);border-radius:999px;font-size:.85rem;color:var(--muted);background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0))}
    .divider{height:1px;background:linear-gradient(90deg, transparent, var(--border), transparent);margin:var(--g-5) 0}
    .quote{margin:.75rem 0 1rem;padding:.75rem 1rem;border-left:3px solid var(--brand-2);background:rgba(13,122,141,.06);font-style:italic;color:var(--txt);border-radius:8px}

    /* ===================== Vertical Interactive Timeline ===================== */
    .timeline { position: relative; display:grid; grid-template-columns: 260px 1fr; gap: var(--g-5); }

    .timeline .rail { position: sticky; top: 72px; align-self: start; height: 70vh; display:flex; flex-direction:column; }

    .rail .yearbox { background: var(--card); border:1px solid var(--border); border-radius: var(--r-2); padding: 1rem; display:grid; gap:.35rem; align-content:start; box-shadow: var(--shadow-1) }
    .rail .yearbox .label { color: var(--muted); font-weight:700; font-size:.85rem }
    .rail .yearbox .value { font-size: 1.75rem; font-weight: 700; letter-spacing:.02em }
    .rail .filters { margin-top: var(--g-3); display:flex; flex-wrap:wrap; gap:.5rem }
    .chip{padding:.35rem .6rem;border:1px solid var(--border);border-radius:999px;background:transparent;font:600 .9rem var(--ff);color:var(--muted);cursor:pointer}
    .chip[aria-pressed="true"]{background:linear-gradient(90deg,var(--brand-1),var(--brand-2));border-color:transparent;color:#fff}

    .rail .progresswrap { position: relative; flex: 1; margin-top: var(--g-4) }
    .rail .progress { position:absolute; left: 50%; transform: translateX(-50%); width:4px; top:0; bottom:0; background: linear-gradient(180deg, transparent, var(--border), transparent); border-radius:999px }
    .rail .progress .fill { position:absolute; left:0; top:0; width:100%; height:0%; background: linear-gradient(180deg, var(--brand-1), var(--brand-2)); border-radius:999px; box-shadow: 0 0 16px rgba(124,58,237,.4) }

    .stream { position: relative; }
    .stream .item { scroll-margin-top: 84px; position: relative; }

    /* list */
    .list { max-height: 66vh; overflow: auto; scroll-snap-type: y proximity; display:grid; gap: var(--g-3) }
    .list::-webkit-scrollbar{width:12px}
    .list::-webkit-scrollbar-thumb{background:linear-gradient(180deg,var(--brand-1),var(--brand-2));border-radius:8px}

    .tcard { position:relative; scroll-snap-align: start; }
    .tcard .meta{display:flex; align-items:center; justify-content:space-between; margin-bottom:.35rem }
    .tcard time{font-weight:700;color:#8c93a3}
    @media (prefers-color-scheme: light){ .tcard time{ color:#2b2f36 } }
    .tcard .cat{font-weight:700;font-size:.8rem;color:var(--muted)}
    .tcard h3{margin:.25rem 0 .2rem;font-size:1.05rem;color:var(--brand-2)}
    .tcard .detail{margin:.25rem 0 0;color:var(--muted)}

    /* bullet + connector */
    .tcard::before{content:""; position:absolute; left:-32px; top:18px; width:12px; height:12px; border-radius:50%; background: radial-gradient(circle at 40% 40%, #fff, var(--brand-1)); box-shadow:0 0 10px rgba(124,58,237,.5) }
    .connector { position:absolute; left:-26px; top:32px; width:0; border-left:2px solid var(--border); height: calc(100% + var(--g-3)); }

    /* collapsible */
    .tcard [data-collapsible]{max-height:0; overflow:hidden; transition:max-height .3s ease}
    .tcard[aria-expanded="true"] [data-collapsible]{max-height:220px}
    .tcard .toggle{position:absolute; right:.8rem; top:.8rem}

    /* ===================== Year grouping (NO sticky label) ===================== */
    .year-section { position: relative; display:grid; gap: var(--g-3); }
    .year-header {
      position: static; top:auto; z-index:auto;
      background: transparent; backdrop-filter:none; border:none; border-radius:0;
      padding:.1rem 0; width:max-content; box-shadow:none; pointer-events:auto;
    }
    .year-header .y { font-weight: 800; letter-spacing:.02em; color: var(--txt); }
    .year-header small { color: var(--muted); font-weight:700; margin-left:.5rem; opacity:.7 }

    /* responsive */
    @media (max-width:920px){
      .timeline{ grid-template-columns: 1fr }
      .rail{ position: static; height:auto }
      .rail .progresswrap{ display:none }
      .list{ scroll-margin-top:0 }
      .tcard::before{ left: -18px }
      .connector{ left: -12px }
      /* year-header ya es estático en mobile */
    }

    /* ===================== Roadmap ===================== */
    .roadmap{display:grid;gap:var(--g-3)}
    @media (min-width:900px){.roadmap{grid-template-columns:1fr 1fr 1fr}}
    .stage h4{margin:0 0 .3rem;font-size:1rem;color:var(--brand-1)}
    .stage ul{margin:.25rem 0 0;padding-left:1.1rem}

    /* ===================== Footer ===================== */
    footer{padding: var(--g-6) 0 var(--g-7);text-align:center;color:var(--muted)}
    .links{display:flex;gap:.5rem;justify-content:center;flex-wrap:wrap}
    .link{color:var(--brand-2);text-decoration:none;font-weight:600;position:relative}
    .link::after{content:"";position:absolute;left:0;bottom:-2px;height:2px;width:0;background:linear-gradient(90deg, var(--brand-1), var(--brand-2));transition:width .25s ease}
    .link:hover::after{width:100%}

    /* Motion preferences */
    @media (prefers-reduced-motion: reduce){.card{transition:none !important}}
  </style>
</head>
<body>
  <a href="#main" class="skip">Skip to content</a>

  <!-- Header -->
  <header class="site">
    <div class="container nav">
      <div class="brand" aria-label="oaibuilds home">
        <span class="dot" aria-hidden="true"></span>
        <span>oaibuilds · O-Systems</span>
      </div>

      <!-- Mobile toggle -->
      <input type="checkbox" id="menu-toggle" aria-label="Open menu" />
      <label for="menu-toggle" class="menu-btn" aria-controls="primary-nav" aria-expanded="false">Menu</label>

      <nav id="primary-nav" class="primary" aria-label="Primary">
        <div class="container">
          <a href="#about">About</a>
          <a href="#projects">Projects</a>
          <a href="#roadmap">Roadmap</a>
          <a href="https://github.com/oaibuilds" target="_blank" rel="noopener">GitHub</a>
        </div>
      </nav>
    </div>
  </header>

  <main id="main">
    <!-- Hero -->
    <section class="container hero" id="home">
      <div>
        <h1 class="h-title">O-Systems by <span class="brandmark">oaibuilds</span></h1>
        <p class="h-sub">Intelligent systems & agentic architectures for an <strong>AI-driven world</strong><span class="nowrap"><strong>— Oriol Martinez</strong></span></p>
        <p class="h-tag">From Zero to Scalable Intelligence<br>— Starting at 30</p>
        <div class="cta">
          <a class="btn primary" href="#projects">Explore Projects</a>
          <a class="btn" href="mailto:oriol@oaibuilds.com">Contact</a>
        </div>
      </div>
      <div class="orbwrap" aria-hidden="true">
        <canvas id="oOrb"></canvas>
        <div class="orbglow"></div>
      </div>
    </section>

    <!-- Banner -->
    <section class="container">
      <div class="ai-banner">
        <p>Minimalism meets intelligence — Building systems that think, adapt, and scale.</p>
        <div class="badges" aria-label="stack badges">
          <span class="badge">Python</span>
          <span class="badge">AI Agents</span>
          <span class="badge">Automation</span>
          <span class="badge">Backtesting</span>
          <span class="badge">Orchestration</span>
        </div>
      </div>
      <div class="divider" role="presentation"></div>
    </section>

    <!-- About + Vertical Timeline -->
    <section id="about" class="container section">
      <article class="card reveal">
        <header><h2>About</h2></header>
        <p><strong>I'm Oriol Martinez.</strong> At 30, I started from zero to build a solid foundation in AI and intelligent automation.</p>
        <p>Between <strong>2022–2024</strong>, I completed a degree in Multiplatform Application Development with <strong>Honours</strong> (top GPA), plus an internship at <strong>Inetum</strong> (backend, APIs, microservices). That gave me core software engineering discipline.</p>
        <p>Today, I’m an <strong>AI Engineering student</strong> at the <strong>Polytechnic University of Catalonia (UPC)</strong> focused on vertical AI agents and Python-based automation systems.</p>
        <blockquote class="quote">Real learning starts when ideas are built. Build → Test → Improve → Repeat. Each loop compounds into scalable, intelligent systems.</blockquote>
        <p>I’m also learning Mandarin to broaden my global perspective and connect with diverse innovation ecosystems.</p><br>

        <!-- ===== Vertical Timeline (data-driven) ===== -->
        <div class="timeline" id="timeline" aria-label="Career timeline">
          <aside class="rail" aria-hidden="false">
            <div class="yearbox" aria-live="polite" aria-atomic="true">
              <div class="label">Year</div>
              <div class="value" id="tlYear">—</div>
              <div class="filters" role="toolbar" aria-label="Filter timeline">
                <button class="chip" data-filter="all" aria-pressed="true">All</button>
                <button class="chip" data-filter="education" aria-pressed="false">Education</button>
                <button class="chip" data-filter="project" aria-pressed="false">Project</button>
                <button class="chip" data-filter="award" aria-pressed="false">Award</button>
              </div>
            </div>
            <div class="progresswrap" aria-hidden="true">
              <div class="progress"><div class="fill" id="tlFill"></div></div>
            </div>
          </aside>

          <div class="stream">
            <ol class="list" id="tlList" aria-describedby="tl-helper"></ol>
            <p id="tl-helper" class="visually-hidden">Use Arrow Up/Down to move between items. Press Enter to expand details.</p>
          </div>
        </div>
      </article>
    </section>

    <!-- Projects intro -->
    <section id="projects" class="container section">
      <article class="card reveal">
        <header><h2>Projects</h2></header>
        <p><strong>The O Project</strong> is a strategic ecosystem of vertical AI agents.<br><br>
        Each agent is laser-focused on a single domain (documents, markets, data streams)
        yet designed to interoperate through a shared orchestration layer.</p>
        <p>The goal: modular pieces that can be combined into scalable, intelligent systems with measurable real-world impact.</p>
      </article>

      <div class="grid cols-2" style="margin-top:var(--g-3)">
        <article class="card reveal">
          <h2>O-Scanner</h2>
          <p>Modular GPT-powered agent for intelligent document classification and organization.</p>
          <a class="btn" href="https://github.com/oaibuilds/O-Scanner" target="_blank" rel="noopener">View on GitHub →</a>
        </article>
        <article class="card reveal">
          <h2>O-Trader</h2>
          <p>Disciplined, AI-aided trading system for signal execution, backtesting, and capital growth.</p>
          <a class="btn" href="https://github.com/oaibuilds/O-Trader" target="_blank" rel="noopener">View on GitHub →</a>
        </article>
      </div>
    </section>

    <!-- Roadmap -->
    <section id="roadmap" class="container section">
      <article class="card reveal">
        <header><h2>Roadmap 2025–2026</h2></header>
        <div class="roadmap">
          <div class="stage">
            <h4>Now</h4>
            <ul>
              <li><strong>O-Trader</strong> — Market automation & signal agents</li>
              <li><strong>O-Scanner</strong> — PDF triage & routing</li>
            </ul>
          </div>
          <div class="stage">
            <h4>Next</h4>
            <ul>
              <li><strong>O-Stream</strong> — LLM-driven insight & content pipelines</li>
              <li><strong>O-Core</strong> — Modular orchestration & system logic</li>
            </ul>
          </div>
          <div class="stage">
            <h4>Later</h4>
            <ul>
              <li><strong>O-Vault</strong> — Structured memory & knowledge systems</li>
            </ul>
          </div>
        </div>
      </article>
    </section>
  </main>

  <footer>
    <div class="container">
      <div class="links">
        <a class="link" href="mailto:oriol@oaibuilds.com">oriol@oaibuilds.com</a>
        <span aria-hidden="true">·</span>
        <a class="link" href="https://www.linkedin.com/in/oriolmartz" target="_blank" rel="noopener">LinkedIn</a>
        <span aria-hidden="true">·</span>
        <a class="link" href="https://github.com/oaibuilds" target="_blank" rel="noopener">GitHub</a>
      </div>
      <div style="margin-top:.5rem">© 2025 oaibuilds.com</div>
    </div>
  </footer>

  <script>
  /* ========================= Utilities ========================= */
  class RevealOnScroll {
    constructor(selector, opts={ threshold: 0.12 }) {
      this.targets = document.querySelectorAll(selector);
      this.io = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{
          if(e.isIntersecting){
            e.target.classList.add('revealed');
            this.io.unobserve(e.target);
          }
        });
      }, opts);
      this.targets.forEach(el=> this.io.observe(el));
    }
  }

  /* ========================= Orb Class ========================= */
  class Orb {
    constructor(el, options={}){
      this.canvas = typeof el === 'string' ? document.querySelector(el) : el;
      if(!this.canvas) return;
      this.ctx = this.canvas.getContext('2d', { alpha:true });
      this.rm = matchMedia('(prefers-reduced-motion: reduce)').matches;

      const defaults = {
        maxDPR: 1.8,
        fpsCap: 60,
        particles: 10,
        ringWidth: 12,
        ringAlpha: 0.85,
        baseScale: 0.44,
        ctaSelector: '.btn.primary'
      };
      this.OPT = { ...defaults, ...options };

      // state
      this.dpr = 1;
      this.t0 = performance.now();
      this.pulseBoost = 0;
      this.running = false;
      this.mx = 0; this.my = 0;
      this.parx = 0; this.pary = 0;
      this.lastFrame = 0;
      this.ioVisible = true;

      // binders
      this._loop = this._loop.bind(this);
      this._toggleLoop = this._toggleLoop.bind(this);
      this._onResize = this._onResize.bind(this);
      this._onMouseMove = this._onMouseMove.bind(this);
      this._onMouseLeave = this._onMouseLeave.bind(this);
      this._onScroll = this._onScroll.bind(this);

      this._setup();
    }

    _clamp(n, a, b){ return Math.min(b, Math.max(a, n)); }

    _sizeCanvas(){
      this.dpr = this._clamp(window.devicePixelRatio || 1, 1, this.OPT.maxDPR);
      const r = this.canvas.getBoundingClientRect();
      const w = Math.max(1, Math.floor(r.width  * this.dpr));
      const h = Math.max(1, Math.floor(r.height * this.dpr));
      if (this.canvas.width !== w || this.canvas.height !== h){
        this.canvas.width  = w;
        this.canvas.height = h;
        this.ctx.setTransform(this.dpr,0,0,this.dpr,0,0);
      }
    }

    _setup(){
      this._sizeCanvas();

      // Resize
      if ('ResizeObserver' in window){
        this.ro = new ResizeObserver(this._onResize);
        this.ro.observe(this.canvas);
      } else {
        addEventListener('resize', this._onResize);
      }

      // Mouse / Scroll parallax
      this.canvas.addEventListener('mousemove', this._onMouseMove);
      this.canvas.addEventListener('mouseleave', this._onMouseLeave);
      this.lastScrollY = window.scrollY;
      addEventListener('scroll', this._onScroll, { passive:true });

      // CTA pulse + click pulse
      this.cta = document.querySelector(this.OPT.ctaSelector);
      if (this.cta){
        this.cta.addEventListener('mouseenter', ()=> this.pulseBoost = Math.max(this.pulseBoost, 1));
      }
      this.canvas.addEventListener('click', ()=> this.pulseBoost = Math.max(this.pulseBoost, 1.2));

      // Pause when offscreen
      if ('IntersectionObserver' in window){
        this.io = new IntersectionObserver(([entry])=>{
          this.ioVisible = entry?.isIntersecting ?? true;
          this._toggleLoop();
        }, { threshold:0.05 });
        this.io.observe(this.canvas);
      }

      // Pause when tab hidden
      document.addEventListener('visibilitychange', this._toggleLoop);

      // First frame + start
      this._draw(performance.now(), 0);
      if(!this.rm) this.start();
    }

    start(){
      if(this.running || this.rm) return;
      this.running = true;
      this.lastFrame = performance.now();
      requestAnimationFrame(this._loop);
    }

    stop(){
      this.running = false;
    }

    destroy(){
      this.stop();
      this.ro?.disconnect?.();
      this.io?.disconnect?.();
      this.cta?.removeEventListener?.('mouseenter', this._ctaEnter);
      this.canvas.removeEventListener('mousemove', this._onMouseMove);
      this.canvas.removeEventListener('mouseleave', this._onMouseLeave);
      removeEventListener('scroll', this._onScroll);
      document.removeEventListener('visibilitychange', this._toggleLoop);
    }

    _onResize(){ this._sizeCanvas(); }
    _onMouseMove(e){
      const r = this.canvas.getBoundingClientRect();
      this.mx = (e.clientX - r.left) / r.width  - .5;
      this.my = (e.clientY - r.top)  / r.height - .5;
    }
    _onMouseLeave(){ this.mx = 0; this.my = 0; }
    _onScroll(){
      const dy = window.scrollY - this.lastScrollY;
      this.lastScrollY = window.scrollY;
      this.my = this._clamp(this.my + dy * -0.0006, -0.6, 0.6);
    }

    _toggleLoop(){
      const shouldRun = !this.rm && this.ioVisible && document.visibilityState === 'visible';
      if (shouldRun && !this.running) this.start();
      else if(!shouldRun) this.stop();
    }

    _loop(now){
      if (!this.running) return;
      const targetDelta = 1000 / this.OPT.fpsCap;
      const dt = now - this.lastFrame;
      if (dt >= targetDelta){
        this.lastFrame = now;
        this._draw(now, dt/1000);
      }
      requestAnimationFrame(this._loop);
    }

    _draw(now, dt){
      const r = this.canvas.getBoundingClientRect();
      const cw = r.width, ch = r.height;
      const ctx = this.ctx;

      ctx.clearRect(0,0,cw,ch);

      const t = (now - this.t0) / 1000;
      const slow = t * 0.5;
      const breath = 0.06 * Math.sin(slow);

      // smooth parallax
      const targetX = this.mx * 14;
      const targetY = this.my * 14;
      this.parx += (targetX - this.parx) * 0.08;
      this.pary += (targetY - this.pary) * 0.08;

      const minSide = Math.min(cw, ch);
      const baseR = minSide * this.OPT.baseScale * (1 + breath*0.5 + this.pulseBoost*0.12);

      // halos
      const bg1 = ctx.createRadialGradient(
        cw*.5 + this.parx, ch*.5 + this.pary, 10,
        cw*.5,             ch*.5,            Math.max(cw,ch)*0.55
      );
      bg1.addColorStop(0, `rgba(124,58,237,${0.18 + 0.06*Math.max(0,breath) + 0.22*this.pulseBoost})`);
      bg1.addColorStop(1, 'rgba(0,0,0,0)');
      ctx.fillStyle = bg1;
      ctx.beginPath(); ctx.arc(cw*.5, ch*.5, minSide*.5, 0, Math.PI*2); ctx.fill();

      const bg2 = ctx.createRadialGradient(
        cw*.5 - this.parx*0.4, ch*.5 - this.pary*0.4, 18,
        cw*.5,                  ch*.5,                 Math.max(cw,ch)*0.85
      );
      bg2.addColorStop(0, `rgba(13,122,141,${0.10 + 0.04*Math.max(0,breath)})`);
      bg2.addColorStop(1, 'rgba(0,0,0,0)');
      ctx.fillStyle = bg2;
      ctx.beginPath(); ctx.arc(cw*.5, ch*.5, minSide*.62, 0, Math.PI*2); ctx.fill();

      // disc
      const disc = ctx.createRadialGradient(
        cw*.5 + this.parx*0.55, ch*.5 + this.pary*0.55, 8,
        cw*.5,                  ch*.5,                   baseR*0.95
      );
      disc.addColorStop(0, '#0f1117');
      disc.addColorStop(1, '#0b0c12');
      ctx.fillStyle = disc;
      ctx.beginPath(); ctx.arc(cw*.5, ch*.5, baseR, 0, Math.PI*2); ctx.fill();

      // inner ring
      ctx.lineWidth = 10;
      ctx.strokeStyle = `rgba(18,24,38,${this.OPT.ringAlpha})`;
      ctx.beginPath(); ctx.arc(cw*.5, ch*.5, baseR*0.68, 0, Math.PI*2); ctx.stroke();

      // brand arc + chromatic stretch
      const ang = this.rm ? 0 : t*0.7;
      ctx.save();
      ctx.translate(cw*.5, ch*.5);
      ctx.rotate(ang + breath*0.5);

      const brand1 = getComputedStyle(document.documentElement).getPropertyValue('--brand-1').trim() || '#7c3aed';
      const brand2 = getComputedStyle(document.documentElement).getPropertyValue('--brand-2').trim() || '#0d7a8d';

      const grad = ctx.createLinearGradient(-baseR*0.75,0, baseR*0.75,0);
      grad.addColorStop(0, brand1);
      grad.addColorStop(1, brand2);
      ctx.strokeStyle = grad;
      ctx.lineWidth = this.OPT.ringWidth + 2*this.pulseBoost;
      ctx.lineCap = 'round';
      ctx.beginPath();
      ctx.arc(0,0, baseR*0.7, -Math.PI*0.28, Math.PI*0.36);
      ctx.stroke();

      ctx.globalAlpha = 0.25 + 0.25*this.pulseBoost;
      ctx.lineWidth = (this.OPT.ringWidth - 6);
      ctx.beginPath();
      ctx.arc(0,0, baseR*0.7 + 1.25, -Math.PI*0.28, Math.PI*0.36);
      ctx.stroke();
      ctx.globalAlpha = 1;
      ctx.restore();

      // moving specular highlight
      ctx.save();
      ctx.translate(cw*.5, ch*.5);
      ctx.rotate(ang*0.6);
      const hx = Math.cos(t*0.9) * baseR*0.35;
      const hy = Math.sin(t*0.9) * baseR*0.35;
      const shine = ctx.createRadialGradient(hx, hy, 0, hx, hy, baseR*0.55);
      shine.addColorStop(0, `rgba(255,255,255,${0.06 + 0.05*Math.max(0,breath) + 0.1*this.pulseBoost})`);
      shine.addColorStop(1, 'rgba(255,255,255,0)');
      ctx.fillStyle = shine;
      ctx.beginPath(); ctx.arc(0,0, baseR*0.95, 0, Math.PI*2); ctx.fill();
      ctx.restore();

      // particles
      if (!this.rm){
        const N = this.OPT.particles;
        for(let i=0;i<N;i++){
          const a = ang + i*(Math.PI*2/N);
          const rr = baseR*(0.62 + 0.12*Math.sin(t*0.7 + i));
          const jx = (Math.sin(t*1.7 + i*2.3))*1.2;
          const jy = (Math.cos(t*1.9 + i*1.7))*1.2;
          const x = cw*.5 + Math.cos(a)*rr + this.parx*0.12 + jx;
          const y = ch*.5 + Math.sin(a)*rr + this.pary*0.12 + jy;
          const alpha = 0.07 + 0.06*Math.sin(t*0.9 + i);
          ctx.fillStyle = `rgba(124,58,237,${alpha + 0.18*this.pulseBoost})`;
          ctx.beginPath(); ctx.arc(x, y, 2, 0, Math.PI*2); ctx.fill();
        }
      }

      // decay
      if (this.pulseBoost > 0){
        this.pulseBoost = Math.max(0, this.pulseBoost - (0.018 + 0.012*dt*60));
      }
    }
  }

  /* ========================= Timeline Class ========================= */
  class Timeline {
    constructor(sel){
      const d = (s)=> document.querySelector(s);
      this.list = typeof sel.list === 'string' ? d(sel.list) : sel.list;
      if(!this.list) return;
      this.yearEl = typeof sel.year === 'string' ? d(sel.year) : sel.year;
      this.fill = typeof sel.fill === 'string' ? d(sel.fill) : sel.fill;
      this.chips = [...document.querySelectorAll(sel.chip || '.chip')];
      this.reduced = matchMedia('(prefers-reduced-motion: reduce)').matches;

      // data (puedes externalizarlo si quieres)
      this.TIMELINE = [
        { id:'t-2022', year:'2022–2024', sortYear:2022, cat:'education',
          title:'DAM (Honours) + Inetum internship',
          detail:'Backend, APIs, microservices; clean architecture, CI & testing habits.',
          badges:['Java','Spring','APIs'] },
        { id:'t-2024', year:'2024', sortYear:2024, cat:'education',
          title:'Started AI Engineering at UPC',
          detail:'Foundations in reasoning, modeling & systems automation.',
          badges:['Python','C++','Algorithms'] },
        { id:'t-2025-hust', year:'2025', sortYear:2025, cat:'award',
          title:'CSC + HUST MSE Scholarship (Wuhan)',
          detail:'AI-enabled robotic design & motion control; AV perception, localization, prediction & planning. Hands-on with humanoid & industrial robots; multimodal generation for recommendation.',
          badges:['Robotics','Autonomy'] },
        { id:'t-2025-oproject', year:'2025', sortYear:2025, cat:'project',
          title:'Launched “The O Project”',
          detail:'Vertical AI agents + orchestration layer. First modules: O-Scanner (docs) and O-Trader (signals/backtests).',
          badges:['Agents','Orchestration'] },
        { id:'t-2026', year:'2026', sortYear:2026, cat:'project',
          title:'Scale agent stack',
          detail:'O-Core (logic) · O-Stream (pipelines) · O-Vault (memory). Tighten eval loops, reliability & latency for production.',
          badges:['Pipelines','RAG','Eval'] }
      ].sort((a,b)=>a.sortYear-b.sortYear);

      this.currentFilter = 'all';
      this._cardsObserver = new IntersectionObserver((entries)=>{
        entries.forEach(en=>{
          if(en.isIntersecting && en.intersectionRatio > 0.6){
            const y = en.target.getAttribute('data-year');
            if (y && this.yearEl) this.yearEl.textContent = y;
          }
        });
      }, { threshold:[0.6] });

      // binders
      this._onClick = this._onClick.bind(this);
      this._onKey = this._onKey.bind(this);
      this._updateProgress = this._updateProgress.bind(this);
      this._deepLink = this._deepLink.bind(this);

      // boot
      this.render();
      this._observeCards();
      this._deepLink();
      this._updateProgress();
      addEventListener('scroll', this._updateProgress, { passive:true });
      addEventListener('resize', this._updateProgress);

      // events
      this.list.addEventListener('click', this._onClick);
      this.list.addEventListener('keydown', this._onKey);
      this.chips.forEach(c=> c.addEventListener('click', ()=>{
        this.currentFilter = c.dataset.filter;
        this.chips.forEach(x=> x.setAttribute('aria-pressed', String(x===c)));
        this.render();
        this._observeCards();
        this._updateProgress();
      }));
      addEventListener('hashchange', this._deepLink);
    }

    _badgeHTML(arr){ return (arr||[]).map(b=>`<span class="badge">${b}</span>`).join(''); }

    render(){
      this.list.innerHTML = '';
      const data = this.TIMELINE.filter(it => this.currentFilter==='all' ? true : it.cat===this.currentFilter);
      const groups = data.reduce((acc, it)=>{ (acc[it.sortYear] ||= []).push(it); return acc; }, {});
      const orderedYears = Object.keys(groups).map(Number).sort((a,b)=>a-b);

      orderedYears.forEach((y)=>{
        const section = document.createElement('li');
        section.className = 'year-section';
        const label = groups[y][0].year;
        section.innerHTML = `<h3 id="year-${y}" class="year-header"><span class="y">${label}</span><small>Milestones</small></h3>`;
        groups[y].forEach((it)=>{
          const art = document.createElement('article');
          art.id = it.id;
          art.className = 'card tcard reveal';
          art.setAttribute('tabindex','0');
          art.setAttribute('aria-expanded','false');
          art.setAttribute('data-year', it.year);
          art.setAttribute('data-cat', it.cat);
          art.innerHTML = `
            <div class="meta">
              <time datetime="${it.sortYear}-01-01">${it.year}</time>
              <span class="cat">${it.cat[0].toUpperCase()+it.cat.slice(1)}</span>
            </div>
            <h3>${it.title}</h3>
            <p class="detail">${it.detail}</p>
            <div class="badges" style="justify-content:flex-start">${this._badgeHTML(it.badges)}</div>
            <button class="btn toggle" aria-label="Expand details" title="Expand">＋</button>
            <div class="connector" aria-hidden="true"></div>
            <div data-collapsible></div>
          `;
          section.appendChild(art);
        });
        this.list.appendChild(section);
      });

      // Init year value
      const first = this.list.querySelector('.tcard');
      if (this.yearEl) this.yearEl.textContent = first?.getAttribute('data-year') || '—';

      // re-apply reveal
      new RevealOnScroll('.reveal, .card');
    }

    _observeCards(){
      this.list.querySelectorAll('.tcard').forEach(c=> this._cardsObserver.observe(c));
    }

    _updateProgress(){
      if(!this.fill) return;
      const stream = this.list.getBoundingClientRect();
      const vh = window.innerHeight || document.documentElement.clientHeight;
      const start = stream.top - (vh*0.15);
      const end = stream.bottom - (vh*0.85);
      const total = Math.max(1, end - start);
      const scrolled = Math.min(Math.max(0, (0 - start)), total);
      const pct = Math.min(100, Math.max(0, (scrolled/total)*100));
      this.fill.style.height = pct + '%';
    }

    _onClick(e){
      const card = e.target.closest('.tcard');
      const toggle = e.target.closest('.toggle');
      if(card && toggle){
        const expanded = card.getAttribute('aria-expanded') === 'true';
        card.setAttribute('aria-expanded', String(!expanded));
        toggle.textContent = expanded ? '＋' : '—';
        if(!this.reduced) card.scrollIntoView({behavior:'smooth', block:'start'});
      }
    }

    _onKey(e){
      const card = e.target.closest('.tcard');
      if(!card) return;
      const cards = [...this.list.querySelectorAll('.tcard')];
      const idx = cards.indexOf(card);
      if(e.key==='Enter' || e.key===' '){ e.preventDefault(); card.querySelector('.toggle')?.click(); }
      if(e.key==='ArrowDown'){ e.preventDefault(); const next = cards[idx+1]; next?.focus({preventScroll:false}); next?.scrollIntoView({behavior: this.reduced?'auto':'smooth', block:'start'}); }
      if(e.key==='ArrowUp'){ e.preventDefault(); const prev = cards[idx-1]; prev?.focus({preventScroll:false}); prev?.scrollIntoView({behavior: this.reduced?'auto':'smooth', block:'start'}); }
    }

    _deepLink(){
      const id = location.hash.slice(1);
      if(!id) return;
      const el = this.list.querySelector('#'+CSS.escape(id));
      if(el){ el.focus({preventScroll:true}); el.scrollIntoView({behavior: this.reduced?'auto':'smooth', block:'start'}); }
    }
  }

  /* ========================= Boot ========================= */
  document.documentElement.classList.remove('no-js');

  // reveal
  new RevealOnScroll('.reveal, .card');

  // orb
  const orb = new Orb('#oOrb', { fpsCap: 60 }); // -> orb.start(), orb.stop(), orb.destroy() disponibles

  // timeline
  const timeline = new Timeline({
    list: '#tlList',
    year: '#tlYear',
    fill: '#tlFill',
    chip: '.chip'
  });
</script>

</body>
</html>
